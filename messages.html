<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Messages - TulongAral+</title>
    <link rel="stylesheet" href="css/styles.css">
    <script>
        window.__VERCEL_LIVE__ = false;
        // Hide Vercel toolbar if it appears
        document.addEventListener('DOMContentLoaded', function() {
            const toolbar = document.querySelector('[style*="z-index"][style*="2147483647"]');
            if (toolbar) toolbar.style.display = 'none';
        });
    </script>
</head>
<body>
    <nav class="main-navbar">
        <div class="logo">
            <h1>TulongAral+</h1>
        </div>
        <div class="nav-links" id="navLinks">
            <!-- Will be populated based on user role -->
        </div>
        <div class="nav-user">
            <span id="userName">User</span>
            <button onclick="logout()" class="btn-secondary btn-sm">Logout</button>
        </div>
    </nav>

    <div class="container">
        <div class="messages-page-header">
            <div class="messages-title-section">
                <h1>Messages</h1>
            </div>
        </div>

        <div class="messages-container">
            <!-- Conversations List -->
            <div class="conversations-panel">
                <div class="conversations-header">
                    <h3>Your Conversations</h3>
                    <p class="conversations-subtitle">Stay connected with the community</p>
                </div>
                <div id="conversationsList" class="conversations-list">
                    <p class="loading">Loading conversations...</p>
                </div>
            </div>

            <!-- Chat Window -->
            <div class="chat-panel">
                <div id="chatPlaceholder" class="chat-placeholder">
                    <div class="placeholder-content">
                        <svg width="120" height="120" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="60" cy="60" r="55" stroke="#e2e8f0" stroke-width="4"/>
                            <path d="M40 50C40 44.4772 44.4772 40 50 40H70C75.5228 40 80 44.4772 80 50V65C80 70.5228 75.5228 75 70 75H55L40 85V50Z" stroke="#2563eb" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                            <circle cx="52" cy="57" r="3" fill="#2563eb"/>
                            <circle cx="60" cy="57" r="3" fill="#2563eb"/>
                            <circle cx="68" cy="57" r="3" fill="#2563eb"/>
                        </svg>
                        <h3>Welcome to Messages</h3>
                        <p>Select a conversation to start messaging</p>
                        <p class="placeholder-hint">Connect with students, sponsors, and get AI assistance</p>
                    </div>
                </div>

                <div id="chatWindow" class="chat-window" style="display: none;">
                    <!-- Chat Header -->
                    <div class="chat-header">
                        <button id="mobileBackButton" class="mobile-back-button" title="Back to conversations">
                            Back
                        </button>
                        <div class="chat-user-info">
                            <img id="chatUserAvatar" src="" alt="Avatar" class="chat-avatar">
                            <div>
                                <h3 id="chatUserName" style="cursor:pointer;text-decoration:underline"></h3>
                                <span id="chatUserRole" class="user-role-badge"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Messages Area -->
                    <div id="messagesArea" class="messages-area">
                        <!-- Messages will be loaded here -->
                    </div>

                    <!-- Message Input -->
                    <div class="message-input-container">
                        <form id="messageForm" class="message-form">
                            <div class="input-wrapper">
                                <input 
                                    type="text" 
                                    id="messageInput" 
                                    placeholder="Type your message..." 
                                    autocomplete="off"
                                >
                                <button type="submit" class="btn-send" title="Send message">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M2 10L18 2L10 18L8 11L2 10Z" fill="currentColor"/>
                                    </svg>
                                </button>
                            </div>
                        </form>
                        <div id="attachmentPreview" class="attachment-preview" style="display: none;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/notifications.js"></script>
    <script src="js/api.js"></script>
    <script src="js/avatars.js"></script>
    <script src="js/gemini-api.js"></script>
    <script src="js/messages.js"></script>
    
    <script>
        console.log(' Debug script loaded');
        window.addEventListener('DOMContentLoaded', () => {
            console.log(' Page loaded - checking messages area...');
            const area = document.getElementById('messagesArea');
            console.log('   messagesArea element:', area);
            console.log('   innerHTML:', area ? area.innerHTML.substring(0, 100) : 'NOT FOUND');
        });
    </script>
    <script>console.log("DEBUG: Page loaded");</script>
</body>
</html>


