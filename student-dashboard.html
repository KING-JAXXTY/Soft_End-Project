<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dashboard - TulongAral+</title>
    <link rel="stylesheet" href="css/styles.css">
    <script>window.__VERCEL_LIVE__ = false;</script>
</head>
<body>
    <nav class="main-navbar">
        <div class="logo">
            <h1>TulongAral+</h1>
        </div>
        <div class="nav-links">
            <a href="student-home.html">Home</a>
            <a href="student-dashboard.html" class="active">Dashboard</a>
            <a href="messages.html">Messages</a>
            <a href="forum.html">Community Forum</a>
            <a href="profile.html">Profile</a>
        </div>
        <div class="nav-user">
            <span id="userName">Student</span>
            <button onclick="logout()" class="btn-secondary btn-sm">Logout</button>
        </div>
    </nav>

    <div class="container">
        <!-- Account Status Alert (if suspended or has warnings) -->
        <div id="accountStatusAlert" style="display: none; margin-bottom: 1.5rem;"></div>

        <div class="dashboard-page-header">
            <div class="dashboard-header-content">
                <div>
                    <h1>My Dashboard</h1>
                    <p class="dashboard-subtitle">Track your scholarship applications</p>
                </div>
                <button onclick="showReportModal()" class="btn-secondary" style="display: flex; align-items: center; gap: 0.5rem;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                        <line x1="12" y1="9" x2="12" y2="13"></line>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                    Report Issue
                </button>
            </div>
        </div>

        <!-- Scholarship Carousel -->
        <div class="scholarship-carousel-container">
            <div class="carousel-header">
                <svg class="carousel-header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7" />
                </svg>
                <h2>New Scholarship Opportunities</h2>
            </div>
            
            <div class="scholarship-carousel">
                <button class="carousel-nav carousel-prev" onclick="navigateCarousel(-1)" aria-label="Previous scholarship">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>

                <div id="carouselSlides" class="carousel-slides">
                    <!-- Loading state -->
                    <div class="carousel-slide active">
                        <div class="carousel-content loading">
                            <div class="loading-spinner"></div>
                            <p>Loading new scholarships...</p>
                        </div>
                    </div>
                </div>

                <button class="carousel-nav carousel-next" onclick="navigateCarousel(1)" aria-label="Next scholarship">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                </button>
            </div>

            <div id="carouselDots" class="carousel-dots">
                <!-- Dots will be generated by JavaScript -->
            </div>
        </div>

        <div class="dashboard-stats">
            <div class="stat-card">
                <div class="stat-icon-wrapper">
                    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                </div>
                <h3 id="totalApplications">0</h3>
                <p>Total Applications</p>
            </div>
            <div class="stat-card success">
                <div class="stat-icon-wrapper success">
                    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <h3 id="approvedApplications">0</h3>
                <p>Approved</p>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon-wrapper warning">
                    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <h3 id="pendingApplications">0</h3>
                <p>Pending</p>
            </div>
            <div class="stat-card danger">
                <div class="stat-icon-wrapper danger">
                    <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <h3 id="rejectedApplications">0</h3>
                <p>Rejected</p>
            </div>
        </div>

        <!-- Applications Section -->
        <div class="dashboard-section applications-section">
            <div class="section-header-applications">
                <div>
                    <h2>My Applications</h2>
                    <p class="section-description">Track and manage your scholarship applications</p>
                </div>
                <select id="statusFilter" class="filter-select" onchange="filterApplications()">
                    <option value="">All Status</option>
                    <option value="pending">Pending</option>
                    <option value="approved">Approved</option>
                    <option value="rejected">Rejected</option>
                </select>
            </div>

            <div id="applicationsList" class="applications-list">
                <!-- Applications will be loaded here -->
            </div>

            <div id="emptyState" class="empty-state-enhanced" style="display: none;">
                <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                <h3>No Applications Yet</h3>
                <p>You haven't applied to any scholarships yet. Browse available scholarships and start your journey!</p>
                <button onclick="window.location.href='student-home.html'" class="btn-primary">Browse Scholarships</button>
            </div>
        </div>

        <!-- Deadline Tracker -->
        <div class="dashboard-section deadline-section">
            <div class="section-header-deadline">
                <div class="deadline-title-wrapper">
                    <svg class="deadline-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <div>
                        <h2>Upcoming Deadlines</h2>
                        <p class="section-description">Stay on track with your applications</p>
                    </div>
                </div>
            </div>

            <div id="deadlinesList" class="deadlines-list">
                <!-- Loading state -->
                <div class="deadline-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading deadlines...</p>
                </div>
            </div>

            <div id="deadlinesEmpty" class="deadlines-empty" style="display: none;">
                <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <h3>All Caught Up!</h3>
                <p>No upcoming deadlines in the next 30 days</p>
            </div>
        </div>
        <!-- My Reports Section (Collapsible) -->
        <div class="dashboard-section" style="margin-top: 2rem;">
            <div class="collapsible-header" onclick="toggleReportsPanel()" style="cursor: pointer; display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: var(--surface); border: 1px solid var(--border-color); border-radius: 8px; transition: all 0.3s ease;">
                <div style="display: flex; align-items: center; gap: 0.75rem;">
                    <svg id="reportsChevron" style="width: 20px; height: 20px; transition: transform 0.3s ease;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                    <h3 style="margin: 0; font-size: 1rem; font-weight: 600;">My Reports</h3>
                    <span id="reportsCount" class="badge" style="background: var(--primary-color); font-size: 0.75rem;">0</span>
                </div>
                <span style="font-size: 0.875rem; color: var(--text-secondary);">Click to expand</span>
            </div>

            <div id="myReportsPanel" style="display: none; margin-top: 1rem; overflow: hidden; transition: all 0.3s ease;">
                <div id="myReportsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem;">
                    <!-- Reports will be loaded here -->
                </div>

                <div id="myReportsEmpty" class="empty-state-enhanced" style="display: none; padding: 2rem;">
                    <svg class="empty-state-icon" style="width: 48px; height: 48px; margin: 0 auto;" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <h4 style="margin-top: 1rem;">No Reports Submitted</h4>
                    <p style="font-size: 0.875rem; color: var(--text-secondary);">You haven't submitted any reports yet.</p>
                </div>
            </div>
        </div>

        <div class="dashboard-section ai-section">
            <div class="section-header-ai" onclick="toggleAISection()" style="cursor: pointer; user-select: none;">
                <div class="ai-section-title">
                    <svg class="ai-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                    </svg>
                    <div>
                        <h2>AI-Powered Recommendations</h2>
                        <p class="ai-description">Get personalized scholarship matches</p>
                    </div>
                </div>
                <span id="aiToggleIcon" class="ai-toggle-icon">â–¼</span>
            </div>
            
            <!-- Collapsible AI Content -->
            <div id="aiSectionContent" style="display: none; margin-top: 1rem;">
                <!-- AI Info Form -->
                <div id="aiInfoForm" style="background: var(--surface); padding: 2rem; border-radius: 1rem;">
                    <p style="margin-bottom: 1.5rem; color: var(--text-secondary);">
                        Please provide the following information to get personalized AI scholarship recommendations:
                    </p>
                    
                    <div style="display: grid; gap: 1rem;">
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">GPA <span style="color: var(--danger);">*</span></label>
                            <input type="number" id="aiGpa" step="0.01" min="0" max="5.0" placeholder="e.g., 3.75" 
                                   style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 0.5rem; background: var(--background);">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Field of Study <span style="color: var(--danger);">*</span></label>
                            <select id="aiFieldOfStudy" 
                                    style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 0.5rem; background: var(--background);">
                                <option value="">Select Field of Study</option>
                                
                                <optgroup label="STEM (Science, Technology, Engineering, Mathematics)">
                                    <option value="Biology">Biology</option>
                                    <option value="Chemistry">Chemistry</option>
                                    <option value="Physics">Physics</option>
                                    <option value="Mathematics">Mathematics</option>
                                    <option value="Statistics">Statistics</option>
                                    <option value="Computer Science">Computer Science</option>
                                    <option value="Information Technology">Information Technology</option>
                                    <option value="Data Science">Data Science</option>
                                    <option value="Engineering">Engineering (Civil, Mechanical, Electrical, etc.)</option>
                                    <option value="Environmental Science">Environmental Science</option>
                                    <option value="Architecture">Architecture</option>
                                    <option value="Astronomy">Astronomy</option>
                                </optgroup>
                                
                                <optgroup label="Health & Medical Sciences">
                                    <option value="Nursing">Nursing</option>
                                    <option value="Medicine">Medicine</option>
                                    <option value="Pharmacy">Pharmacy</option>
                                    <option value="Medical Technology">Medical Technology</option>
                                    <option value="Public Health">Public Health</option>
                                    <option value="Physical Therapy">Physical Therapy</option>
                                    <option value="Nutrition & Dietetics">Nutrition & Dietetics</option>
                                    <option value="Dentistry">Dentistry</option>
                                    <option value="Veterinary Medicine">Veterinary Medicine</option>
                                </optgroup>
                                
                                <optgroup label="Business & Economics">
                                    <option value="Business Administration">Business Administration</option>
                                    <option value="Accountancy">Accountancy</option>
                                    <option value="Economics">Economics</option>
                                    <option value="Finance">Finance</option>
                                    <option value="Marketing">Marketing</option>
                                    <option value="Entrepreneurship">Entrepreneurship</option>
                                    <option value="Human Resource Management">Human Resource Management</option>
                                    <option value="Management Information Systems">Management Information Systems</option>
                                </optgroup>
                                
                                <optgroup label="Social Sciences">
                                    <option value="Psychology">Psychology</option>
                                    <option value="Sociology">Sociology</option>
                                    <option value="Anthropology">Anthropology</option>
                                    <option value="Political Science">Political Science</option>
                                    <option value="International Relations">International Relations</option>
                                    <option value="Criminology">Criminology</option>
                                    <option value="Social Work">Social Work</option>
                                    <option value="Development Studies">Development Studies</option>
                                </optgroup>
                                
                                <optgroup label="Humanities & Arts">
                                    <option value="Literature">Literature</option>
                                    <option value="Philosophy">Philosophy</option>
                                    <option value="History">History</option>
                                    <option value="Linguistics">Linguistics</option>
                                    <option value="Communication Arts">Communication Arts</option>
                                    <option value="Journalism">Journalism</option>
                                    <option value="Fine Arts">Fine Arts</option>
                                    <option value="Performing Arts">Performing Arts</option>
                                    <option value="Music">Music</option>
                                    <option value="Theater">Theater</option>
                                </optgroup>
                                
                                <optgroup label="Education">
                                    <option value="Elementary Education">Elementary Education</option>
                                    <option value="Secondary Education">Secondary Education</option>
                                    <option value="Special Education">Special Education</option>
                                    <option value="Early Childhood Education">Early Childhood Education</option>
                                    <option value="Educational Management">Educational Management</option>
                                    <option value="Physical Education">Physical Education</option>
                                </optgroup>
                                
                                <optgroup label="Law & Legal Studies">
                                    <option value="Law">Law</option>
                                    <option value="Legal Management">Legal Management</option>
                                    <option value="Paralegal Studies">Paralegal Studies</option>
                                </optgroup>
                                
                                <optgroup label="Agriculture & Related Fields">
                                    <option value="Agriculture">Agriculture</option>
                                    <option value="Agribusiness">Agribusiness</option>
                                    <option value="Agricultural Engineering">Agricultural Engineering</option>
                                    <option value="Forestry">Forestry</option>
                                    <option value="Fisheries">Fisheries</option>
                                </optgroup>
                                
                                <optgroup label="Technical & Vocational">
                                    <option value="Automotive Technology">Automotive Technology</option>
                                    <option value="Electronics Technology">Electronics Technology</option>
                                    <option value="Welding Technology">Welding Technology</option>
                                    <option value="Culinary Arts">Culinary Arts</option>
                                    <option value="Hotel & Restaurant Management">Hotel & Restaurant Management</option>
                                    <option value="Tourism Management">Tourism Management</option>
                                </optgroup>
                                
                                <optgroup label="Maritime & Aviation">
                                    <option value="Marine Engineering">Marine Engineering</option>
                                    <option value="Marine Transportation">Marine Transportation</option>
                                    <option value="Aeronautical Engineering">Aeronautical Engineering</option>
                                </optgroup>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Year Level <span style="color: var(--danger);">*</span></label>
                            <select id="aiYearLevel" 
                                    style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 0.5rem; background: var(--background);">
                                <option value="">Select Year Level</option>
                                <option value="1st Year">1st Year</option>
                                <option value="2nd Year">2nd Year</option>
                                <option value="3rd Year">3rd Year</option>
                                <option value="4th Year">4th Year</option>
                                <option value="Graduate">Graduate</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Financial Need <span style="color: var(--danger);">*</span></label>
                            <select id="aiFinancialNeed" 
                                    style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 0.5rem; background: var(--background);">
                                <option value="">Select Financial Need</option>
                                <option value="High">High - Need full financial support</option>
                                <option value="Medium">Medium - Need partial support</option>
                                <option value="Low">Low - Can cover most expenses</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Achievements & Awards <span style="color: var(--danger);">*</span></label>
                            <textarea id="aiAchievements" rows="3" placeholder="List your academic achievements, awards, competitions, leadership roles, etc." 
                                      style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 0.5rem; background: var(--background); resize: vertical;"></textarea>
                        </div>
                        
                        <button onclick="submitAIInfo()" class="btn-primary" style="margin-top: 1rem;">
                            Get AI Recommendations
                        </button>
                    </div>
                </div>
                
                <!-- AI Results Container (hidden initially) -->
                <div id="aiRecommendationsContainer" style="margin-top: 1rem; display: none;">
                    <!-- AI recommendations will be displayed here -->
                </div>
            </div>
        </div>

    </div>

    <!-- Report Issue Modal -->
    <div id="reportModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closeReportModal()">&times;</span>
            <h2 style="margin-bottom: 1.5rem;">Report an Issue</h2>
            
            <form id="reportForm" onsubmit="submitReport(event)">
                <div class="form-group">
                    <label for="reportType">Report Type *</label>
                    <select id="reportType" class="form-control" required>
                        <option value="">Select type...</option>
                        <option value="Technical Issue">Technical Issue</option>
                        <option value="Scholarship Issue">Scholarship Issue</option>
                        <option value="User Complaint">User Complaint</option>
                        <option value="Payment Issue">Payment Issue</option>
                        <option value="Feature Request">Feature Request</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="reportSubject">Subject *</label>
                    <input type="text" id="reportSubject" class="form-control" required maxlength="200" placeholder="Brief description of the issue">
                </div>

                <div class="form-group">
                    <label for="reportDescription">Description *</label>
                    <textarea id="reportDescription" class="form-control" required rows="5" placeholder="Provide detailed information about the issue..."></textarea>
                </div>

                <div class="form-group">
                    <label for="reportedUserId">
                        Reported User ID (Optional)
                        <span style="font-size: 0.875rem; color: var(--text-secondary); font-weight: normal;">
                            - If reporting a user, enter their User ID (found on their profile)
                        </span>
                    </label>
                    <input type="text" id="reportedUserId" class="form-control" placeholder="e.g., TA-ABC12345" pattern="TA-[A-Z0-9]{8}" title="Format: TA-XXXXXXXX">
                    <small style="color: var(--text-secondary); font-size: 0.8125rem;">User ID format: TA-XXXXXXXX (8 characters)</small>
                </div>

                <div class="modal-actions" style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" onclick="closeReportModal()" class="btn-secondary">Cancel</button>
                    <button type="submit" class="btn-primary">Submit Report</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/gemini-api.js"></script>
    <script src="js/api.js"></script>
    <script src="js/certificate.js"></script>
    <script src="js/student-dashboard.js"></script>
</body>
</html>
